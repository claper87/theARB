<template>
    <lightning-card variant="narrow" icon-name="standard:report" title="Custom Reports Generator">

        <div slot="actions">
            <div class="slds-grid slds-m-bottom_small slds-m-right_small">
                <div class="slds-col slds-no-flex slds-m-right_small slds-grid slds-shrink">
                    <lightning-combobox disabled={isLoading} name="reportName" label="Report Name"
                        value={selectedReportName} placeholder="Select Report" options={activeReportOptionList}
                        variant="label-hidden" onchange={handleReportNameChange} required></lightning-combobox>

                </div>
                <div class="slds-col">
                    <lightning-button-group>
                        <lightning-button label="Export" disabled={disableDownloadButton} onclick={handleDownloadReport}
                            icon-name="utility:download" variant="brand"></lightning-button>
                        <lightning-button label="Stop" disabled={disableStopButton} onclick={handleStop}
                            icon-name="utility:stop" variant="destructive"></lightning-button>

                    </lightning-button-group>


                </div>
            </div>

        </div>

        <div class="slds-box slds-theme_default slds-m-around_xx-large loaderArea">

            <p><strong>Selected Report:</strong> {selectedReportLabel}</p>
            <p><strong>Elapsed Time:</strong> {elapsedTimestamp}</p>
            <p><strong>Total Records Loaded:</strong> {totalRecords}</p>
            <lightning-spinner lwc:if={isLoading} alternative-text="Loading" size="medium">
            </lightning-spinner>
        </div>


    </lightning-card>

    <c-excel-generator header-list={headerList} filename={filename} worksheet-name-list={worksheetNameList}
        sheets-data={xlsData}></c-excel-generator>

</template>